---
title: 攻克Redis
date: 2020-09-04 10:02:13
---
##### 基本使用







##### 一些问题

1. Redis中Hash结构的扩容机制是什么？

2. Redis的部署有哪些方式？

3. Redis是如何主从复制的？

4. Redis中跳表的原理

   跳表的原理类似二分查找，但是数据结构用的链表，跳表在原有的有序链表上面增加了多级索引，通过索引来实现快速查找。

   创建索引会占据一定性能，在插入或者删除数据时，如果没插入或删除一个元素就重新创建索引又有点浪费，所以需要平衡一下，比如记录最底层的索引间的元素个数间隔，超过多少个再重新创建索引。

   二分查找算法之所以能达到 O(logn) 这样高效的一个重要原因在于它所依赖的数据结构是数组，数组支持随机访问一个元素，通过下标很容易定位到中间元素。而链表是不支持随机访问的，只能从头到尾依次访问。但是数组有数组的局限性，比如需要连续的内存空间，插入删除操作会引起数组的扩容和元素移动，链表有链表的优势，链表不需要先申请连续的空间，插入删除操作的效率非常高。所以有了跳表。

   

   Example:

   假如链表中有 n 个元素，我们每两个节点建立一个索引，

   那么第 1 级索引的结点个数就是 n/2 ，第二级就是 n/4，第三级就是 n/8, 依次类推，**那么第k级索引的节点个数为 n 除以 2 的 k 次方，即 n/(2^k)。**

   假设索引有 h 级，最高级的索引有 2 个结点。通过上面的公式，我们可以得到 n/(2^h) = 2，得到 h=log2n - 1，包含原始链表这一层的话，跳表的高度就是 log2n，假设每层需要访问 m 个结点，那么总的时间复杂度就是O(m*log2n)。而每层需要访问的 m 个结点，m 的最大值不超过 3，所以查找的时间复杂度为O(logn)。

   查询效率的提升，是拿空间换时间得到的。

   假设原始链表大小为 n，这几级索引的结点总和就是 n/2+n/4+n/8…+8+4+2=n-2。所以，跳表的空间复杂度是 O(n)。也就是说，如果将包含 n 个结点的单链表构造成跳表，我们需要额外再用接近 n 个结点的存储空间。在实际的软件开发中，原始链表中存储的有可能是很大的对象，而索引结点只需要存储关键值和几个指针，并不需要存储对象，所以当对象比索引结点大很多时，那索引占用的额外空间就可以忽略了。

   当我们往跳表中插入数据的时候，通过一个随机函数，来决定将这个结点插入到哪几级索引中，比如随机函数生成了值 K，那我们就将这个结点添加到**第一级到第 K 级这 K 级**索引中。

   **跳表是一种动态数据结构，支持快速的插入、删除、查找操作，时间复杂度都是 O(logn)。**跳表的空间复杂度是 O(n)。不过，跳表的实现非常灵活，可以通过**改变索引构建策略，有效平衡执行效率和内存消耗。

5. Redis底层数据结构
6. Redis的新版本的一些功能以及对于redis配置文件，一般需要通过配置文件来解决问题

   


##### 好玩的
```lua
-- 配合各种Escape Sequence
string.rep('hahaha\t', 10)
```
##### 相关介绍

##### 参考
- https://www.tutorialspoint.com/lua/index.htm

